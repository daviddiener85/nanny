<!DOCTYPE html>
<html>
<head>
    <title>Nanny Finder</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 40px auto;
        }
        h1 {
            margin-bottom: 10px;
        }
        button {
            padding: 10px 16px;
            cursor: pointer;
        }
        .card {
            border: 1px solid #ddd;
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <h1>Nanny Finder</h1>
    <button onclick="loadNannies()">Load available nannies</button>
    <div id="results"></div>

    <script>
                async function loadNannies() {
                    const res = await fetch("/nannies/search?parent_user_id=1");
                    const data = await res.json();

                    const nannies = data.results || [];
                    const container = document.getElementById("results");
                    container.innerHTML = "";

                    if (nannies.length === 0) {
                        container.innerHTML = `<p>${data.message || "No nannies found."}</p>`;
                        return;
                    }

                    nannies.forEach(n => {
                        const div = document.createElement("div");
                        div.className = "card";

                        const avg = n.average_rating_12m;
                        const cnt = n.review_count_12m;
                        const ratingText =
                          (cnt && cnt > 0)
                            ? `⭐ ${(avg ?? 0).toFixed(1)} (${cnt} review${cnt === 1 ? "" : "s"})`
                            : "⭐ New";

                        div.innerHTML = `
                            <strong>${n.name}</strong><br/>
                            <span class="muted">${ratingText}</span><br/>
                            Age: ${n.age ?? "Unknown"}<br/>
                            Languages: ${(n.languages || []).map(l => l.name).join(", ")}<br/>
                            Qualifications: ${(n.qualifications || []).map(q => q.name).join(", ")}<br/>
                            Bio: ${n.bio || ""}
                        `;
                        container.appendChild(div);
                    });
                }
    </script>
</body>
</html>
